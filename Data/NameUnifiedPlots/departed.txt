In voiceover, IrishAmerican mobster Frankcostello explains that he doesn't want to be the product of his environment, he wants his environment to be a product of him. Grainy historical film depicts violent riots in Boston during earlier generations. Frankcostello. proudly Irish, unapologetically racist, explains that what annoys him about African Americans is their refusal to realize that they won't be given anything. Frankcostello.s belief is you have to do whatever possible to take what you want.  Frankcostello is in a small convenience store and collects protection money from the shop owner, who is visibly unnerved by Frankcostello. Frankcostello warns him to have more money next time. Frankcostello asks the shop owner's young teenage daughter behind the counter if she's got her period yet. His attitude is nonchalant and all the more threatening for it. The daughter is both affronted and compelled by the powerful Frankcostello and answers his rhetorical question. The shop owner doesn't show any emotion.  A small boy, a young Colinsullivan, is at the counter and witnesses Frankcostello.s interaction with the shop owner. Frankcostello notices him and asks him if he's the son of a man Frankcostello knows. He tells the store owner to give the boy two full bags of groceries and then presses some coins into the boy's hand. He tells the boy to remember he can get more money from Frankcostello when he gets older.  As Colinsullivan grows, Frankcostello grooms him and steers him into a job as a police officer, where he can keep Frankcostello informed. Colinsullivan completes the Police Academy and is immediately transferred to the State Police force. He is accepted into the Special Investigations Unit led by Ellerby which focuses on organized crime. The primary target of the unit is Frankcostello. Colinsullivan is warmly welcomed onto the State Police force by Captain Queenan and Staff Sergeant Dignam.  Billycostigan, whose extended family has considerable ties to organized crime, also attends the police academy. Before he graduates, he is summoned to a meeting with Queenan and Dignam who intimidate, bully, and verbally harass him. They pressure him to disqualify himself as an officer because he's too smart to be a cop and because of his family's ties to crime. When Billycostigan stands up to their hazing, they alter tactics they offer him a job as a police officer on one condition that he quit the academy, serve serious time in jail on a trumpedup assault charge, and infiltrate Frankcostello.s organization. Only Queenan and Dignam will know that Billycostigan is working undercover. They promise him a bonus when he completes the assignment.  When Billycostigan gets out of prison, he contacts his cousin and tries to finance a drug deal. Billycostigan and his cousin meet Mr. French at a local bar, where Billycostigan orders a cranberry juice. The guy on the bar stool next to him asks Billycostigan if he is having his period. Billycostigan smashes a beer mug over the man's head and is halted in his assault by Mr. French. Mr. French warns Billycostigan that he is not allowed to beat up certain men, and he's lucky the guy at the bar is not one of them.  Eating at the counter of a store like that in which Colinsullivan originally met Frankcostello. Billycostigan confronts two Italian mobsters from Providence extorting protection money from the store owner. He beats the two men up badly, breaking his hand when he hits one of them. Frankcostello learns of Billycostigan.s actions and summons him to a meeting. He offers to protect Billycostigan from the Mafia, who, he promises, will return with reinforcements to kill Billycostigan. He invites Billycostigan into a back room where he instructs Mr. French, a senior member of Frankcostello.s crew, to check Billycostigan for weapons or a wire. Mr. French breaks Billycostigan.s cast open and Frankcostello beats Billycostigan.s broken hand with a shoe, trying to get him to confess being a cop. Billycostigan withstands their beating and is accepted as a legitimate crook by Frankcostello.  Both Colinsullivan and Billycostigan gain credibility within their respective organizations. Colinsullivan visits a crime scene where the two Mafia men from Providence are found. Colinsullivan contacts Frankcostello. who directs him to influence the investigators away from Frankcostello.  Colinsullivan begins dating psychiatrist Madolynmadden. Billycostigan also sees her but as a client, required under the terms of his probation. He also develops an attraction to her. During a deal to sell stolen missile guidance microchips to Chinese government agents, Colinsullivan warns Frankcostello of the police operation and everyone avoids police detection by boarding boats waiting at the back of the warehouse.  It becomes evident to both Colinsullivan and Billycostigan that there is a mole in each other's organization, though not their identities. Billycostigan talks to Dignam and threatens to leave but Dignam tells him to come up with evidence so they can find the mole. Extremely agitated, Billycostigan relents. He has coffee with Madolynmadden who is moving in to live with Colinsullivan.  Frankcostello tells Colinsullivan to find the rat among his crew. Colinsullivan asks for his crew members' social security numbers and other ID so he can track them down. Billycostigan searches for the informant and learns from a member of Frankcostello.s crew that Frankcostello is an FBI informant, explaining why federal prosecutors repeatedly fail to indict and arrest Frankcostello. Billycostigan visits Queenan at home late at night and tells him that Frankcostello is an FBI informant.  Mr. French collects everyone's social security numbers and other ID. Billycostigan corrects Fitzgibbons's misspelling of 'citizens' on the envelope containing their information and then leaves. He visits Madolynmadden at her apartment, where she is finishing moving out. She tells him she is moving in with Colinsullivan. They talk and then have sex.  Ellerby puts Colinsullivan in charge of the investigation to find the mole in the Special Investigations Unit, citing his immaculate record. Billycostigan follows Frankcostello to a porn theater, where he sees Frankcostello meet with and give a dark figureunknown to him, Colinsullivan.he envelope containing Frankcostello.s crew members' personal information. Billycostigan chases Colinsullivan out the emergency exit of the theater and through Chinatown but neither man learns the other's identity.  Colinsullivan tells Frankcostello to trail Queenan to a meeting with Billycostigan. Billycostigan gets away before Frankcostello.s men throw Queenan off the roof, landing at Billycostigan.s feet. As Frankcostello.s crew leaves, Billycostigan joins them, pretending he's just arrived to join them in the assassination. Delahunt is mortally wounded. Back at their bar, Delahunt fingers Billycostigan as the mole but dies before he can tell anyone else.  A news report reveals that Delahunt, a crew member, was an undercover cop. Dignam is forced to step down from the police force as a result.  Using Queenan's phone, Colinsullivan reaches Billycostigan. and fails to persuade him to quit his work as a mole. Colinsullivan learns from Queenan's diary that Frankcostello was an informant for the Federal Bureau of Investigation. He worries that his identity as a mole for Frankcostello may be revealed. With Billycostigan.s help, Frankcostello is traced by the police to a cocaine pickup, where a gunfight erupts between his crew and police, during which most of Frankcostello.s crew is killed. Colinsullivan confronts the wounded Frankcostello. who admits he is an occasional FBI informant. Colinsullivan shoots him multiple times. Colinsullivan is applauded the next day for having killed Frankcostello by everyone on the force.  In good faith, Billycostigan comes to see him, seeking to get his civilian identity restored and to collect his back pay. He tells Colinsullivan he intends to resume his civilian life. Colinsullivan leaves to look up Billycostigan.s employee record when Billycostigan notices the envelope from Frankcostello on Colinsullivan.s desk. Billycostigan finally realizes Colinsullivan is Frankcostello.s mole. Returning to his desk, Colinsullivan realizes that Billycostigan has figured out his true identity, so he erases Billycostigan.s employee records from the police computer system.  Madolynmadden tells Colinsullivan she's pregnant, but doesn't reveal who the father is. A few days later she receives a package in the mail from Billycostigan addressed to Colinsullivan. She opens it to find it contains a CD of Frankcostello.s recorded conversations with Colinsullivan. Colinsullivan walks in as she is listening and tries unsuccessfully to assuage her suspicions. He contacts Billycostigan. who reveals that Frankcostello recorded every conversation he had with Colinsullivan. Frankcostello left the recordings with his attorney, who has given them to Billycostigan. Billycostigan says he wants his civilian identity back or he will implicate Colinsullivan. They agree to meet on the roof of the building where Queenan died.  When they meet, Billycostigan catches Colinsullivan offguard and handcuffs him. As Billycostigan had secretly arranged, Officer Brown appears on the roof as well. Shocked to see Colinsullivan in handcuffs and held at gunpoint by Billycostigan. Brown draws his gun on Billycostigan. Billycostigan explains his actions by revealing that Colinsullivan is the mole. Billycostigan asks Brown why Dignam did not accompany him, but Brown doesn't answer. Billycostigan leads Colinsullivan to the elevator and Brown takes the stairs to follow them.  When the elevator reaches the ground floor and the doors open, Officer Barrigan shoots Billycostigan in the head. When Brown arrives, Barrigan kills him too. Barrigan reveals to Colinsullivan that Frankcostello had more than one mole in the police and that Frankcostello was going to give both of them up to the FBI. When Barrigan momentarily turns, Colinsullivan shoots him in the head. At police headquarters, Colinsullivan concocts a story to protect himself, identifying Barrigan as the mole and recommends Billycostigan for the Medal of Merit.  At Billycostigan.s funeral, Colinsullivan and Madolynmadden stand by the grave. Colinsullivan attempts to talk to her, but she ignores him. As Colinsullivan enters his apartment, he is met by Dignam, who shoots and kills him.